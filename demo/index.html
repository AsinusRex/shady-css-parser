<!doctype html>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shady CSS Parser</title>
    <script src="//polygit.org/components/webcomponentsjs/webcomponents-lite.js"></script>
    <link rel="import" href="../shady-css-parser.html">
    <link rel="import" href="components.html">
  </head>
  <body>
    <parser-demo></parser-demo>
    <dom-module id="parser-demo">
      <template>
        <style>
          :host {
            --paper-input-container-input: {
              font-size: 12px;
              line-height: 12px;
              font-family: monospace;
            };
          }

          section {
            @apply(--layout-flex);
            @apply(--layout-horizontal);
            max-width: 100vw;
            max-height: 100vh;
            padding-bottom: 1em;
            box-sizing: border-box;
          }

          pre {
            white-space: pre-wrap;
          }

          paper-material {
            @apply(--layout-flex);
            overflow: auto;
            font-size: 12px;
            margin: 1em;
            padding: 1em;
            max-height: 100%;
          }
        </style>
        <iron-ajax url="test.css" handle-as="text" last-response="{{cssSource}}" auto></iron-ajax>
        <section>
          <paper-material>
            <paper-textarea no-label-float value="{{cssSource}}"></paper-textarea>
          </paper-material>
          <paper-material>
            <pre><code>[[_computeAst(cssSource)]]</code></pre>
          </paper-material>
          <paper-material>
            <pre><code>[[_computeTokens(cssSource)]]</code></pre>
          </paper-material>
        </section>
      </template>
    </dom-module>
    <script>
      document.addEventListener('WebComponentsReady', function() {
        Polymer({
          is: 'parser-demo',

          properties: {
            cssSource: {
              type: String,
              notify: true
            }
          },

          _computeTokens: function(cssSource) {
            return this._stringify(shadyCssParser.lex(cssSource));
          },

          _computeAst: function(cssSource) {
            return this._stringify(shadyCssParser.parse(cssSource));
          },

          _stringify: function(object) {
            return JSON.stringify(object, null, '  ');
          }
        });
      });
    </script>
  </body>
</html>
